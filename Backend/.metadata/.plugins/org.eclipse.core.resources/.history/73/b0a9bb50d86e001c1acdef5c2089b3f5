package com.coforge.training.airline.serviceImpl;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.coforge.training.airline.model.BookFlightSeatData;
import com.coforge.training.airline.model.Seats;
import com.coforge.training.airline.repository.SeatsRepo;
import com.coforge.training.airline.response.SeatAvailableResponse;
import com.coforge.training.airline.response.checkSeatsReponse;
import com.coforge.training.airline.service.SeatService;

@Service
public class SeatServiceImpl implements SeatService{

	@Autowired
	private SeatsRepo repo;
	
	@Autowired
	private BookFlightSeatDateServiceImpl service;

	@Override
	public List<Seats> getBookFlightSeatData(long flightid, String seattype) {
		// TODO Auto-generated method stub
		return repo.findAllByFlightidAndSeattype(flightid, seattype);
	}

	@Override
	public List<Seats> getFlightBySeats(long flightid) {
		// TODO Auto-generated method stub
		return repo.findByFlightid(flightid);
	}

	@Override
	public String deleteById(long seatid) {
		// TODO Auto-generated method stub
		if(repo.existsById(seatid))
		{
			repo.deleteById(seatid);
			return "Delete Seat";
		}
		return "Id is not exist";
	}

	@Override
	public SeatAvailableResponse getBookdataByFlightSeatData(long flightid, String seattype) {
		// TODO Auto-generated method stub
		SeatAvailableResponse res=new SeatAvailableResponse();
		Seats seat=repo.findByFlightidAndSeattype(flightid, seattype);
		
		res.setFlightid(seat.getFlightid());
		res.setSeatid(seat.getSeatid());
		res.setSeatprize(seat.getSeatprize());
		res.setSeattype(seat.getSeattype());
		res.setTotalseats(seat.getTotalseats());
		checkSeatsReponse check=service.checkSeatAvailability(flightid,seattype);
		res.setAvailableseat(check.getAvailableseats());
		
		return res;
	}
	
}
